{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## SOCRadar TAXII Threat Intelligence Dashboard\n\nMonitor IOC ingestion from SOCRadar TAXII 2.1 feeds."
      },
      "name": "header"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 604800000
            },
            "typeSettings": {
              "selectableValues": [
                { "durationMs": 3600000 },
                { "durationMs": 14400000 },
                { "durationMs": 86400000 },
                { "durationMs": 259200000 },
                { "durationMs": 604800000 },
                { "durationMs": 2592000000 }
              ]
            },
            "label": "Time Range"
          }
        ]
      },
      "name": "parameters"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "ThreatIntelligenceIndicator\n| where Tags has \"SOCRadar\" and Tags has \"TAXII\"\n| where TimeGenerated {TimeRange}\n| where Active == true\n| summarize Count=count() by IndicatorType=ThreatType\n| order by Count desc",
        "size": 3,
        "title": "Active Indicators by Type",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "piechart"
      },
      "customWidth": "50",
      "name": "indicators-by-type"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "ThreatIntelligenceIndicator\n| where Tags has \"SOCRadar\" and Tags has \"TAXII\"\n| where TimeGenerated {TimeRange}\n| where Active == true\n| extend ConfidenceTier = case(\n    ConfidenceScore >= 80, \"High (80-100)\",\n    ConfidenceScore >= 50, \"Medium (50-79)\",\n    ConfidenceScore >= 20, \"Low (20-49)\",\n    \"Minimal (0-19)\")\n| summarize Count=count() by ConfidenceTier\n| order by Count desc",
        "size": 3,
        "title": "Indicators by Confidence",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "piechart"
      },
      "customWidth": "50",
      "name": "indicators-by-confidence"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "ThreatIntelligenceIndicator\n| where Tags has \"SOCRadar\" and Tags has \"TAXII\"\n| where TimeGenerated {TimeRange}\n| summarize Created=count() by bin(TimeGenerated, 1h)\n| order by TimeGenerated asc",
        "size": 0,
        "title": "Ingestion Over Time",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "timechart"
      },
      "name": "ingestion-timechart"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "ThreatIntelligenceIndicator\n| where Tags has \"SOCRadar\" and Tags has \"TAXII\"\n| where TimeGenerated {TimeRange}\n| where Active == true\n| project TimeGenerated, ThreatType, DisplayName, ConfidenceScore, ExpirationDateTime, Source\n| order by TimeGenerated desc\n| take 50",
        "size": 0,
        "title": "Recent Indicators (Last 50)",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "table"
      },
      "name": "recent-indicators"
    },
    {
      "type": 1,
      "content": {
        "json": "## Ingestion Health\n\nRequires SOCRadar-TAXII-Infrastructure playbook deployment for audit logging."
      },
      "name": "health-header"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "SOCRadar_TAXII_Import_CL\n| where TimeGenerated {TimeRange}\n| project TimeGenerated, CollectionID, Status, IndicatorsProcessed, IndicatorsCreated, IndicatorsFailed, PagesFetched, DurationMs, ErrorMessage\n| order by TimeGenerated desc\n| take 20",
        "size": 0,
        "title": "Recent Import Runs",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "table"
      },
      "name": "import-runs"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "SOCRadar_TAXII_Import_CL\n| where TimeGenerated {TimeRange}\n| summarize TotalProcessed=sum(IndicatorsProcessed), TotalCreated=sum(IndicatorsCreated), TotalFailed=sum(IndicatorsFailed), Runs=count() by bin(TimeGenerated, 1d)\n| order by TimeGenerated asc",
        "size": 0,
        "title": "Daily Ingestion Summary",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "timechart"
      },
      "name": "daily-summary"
    }
  ],
  "fallbackResourceIds": [],
  "fromTemplateId": "sentinel-SOCRadarTAXII"
}
